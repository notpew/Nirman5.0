<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   Language Selection | Heisenberg Protocol
  </title>
  <link href="https://fonts.googleapis.com" rel="preconnect"/>
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
  <!-- Tailwind CSS CDN -->
  <script>
   tailwind = undefined;
window.tailwind = window.tailwind || {};
window.tailwind.config = {
    darkMode: 'class',
    theme: {
        extend: {
            fontFamily: {
                sans: ['Poppins', 'ui-sans-serif', 'system-ui'],
            },
            colors: {
                yieldGreen: '#2E7D32',
            },
        },
    },
};
  </script>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <!-- Font Awesome 6 -->
  <link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-Sl1b5I0mA4qgK3pIY6qjHc9jXHk7W/TvZpQf3g7Dbh7b2AqFZkWfZg+v0o5uQK3VwA2oUoM0b7lV8eTq6VQW7g==" referrerpolicy="no-referrer" rel="stylesheet">
   <!-- SweetAlert2 -->
   <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js">
    </script>
    <!-- Page Theme & Common Styles -->
    <link href="style.css" rel="stylesheet">
     <!-- Page-specific CSS: Language Selection (can be moved to language_selection.css) -->
     <style>
      /* Page-specific styles: keep minimal and non-conflicting with global theme */
    .lang-card {
      background: linear-gradient(180deg, rgba(46, 125, 50, 0.05) 0%, rgba(46, 125, 50, 0.02) 100%);
      border: 1px solid rgba(46, 125, 50, 0.15);
      backdrop-filter: blur(6px);
    }
    .lang-btn {
      transition: transform 200ms ease, box-shadow 200ms ease;
    }
    .lang-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(46, 125, 50, 0.15);
    }
    .voice-toggle input:checked + .toggle-dot {
      transform: translateX(1.25rem);
    }
     </style>
    </link>
   </link>
  </link>
 
<!-- CSS Loader Script -->
<script src="./css_loader.js"></script>
</head>
 <body class="font-sans bg-[#f9fafb] text-gray-800 dark:bg-gray-900 dark:text-gray-100 min-h-screen flex flex-col">
  <!-- Header (common component - included as needed for brand consistency; sidebar is not required on language selection page) -->
  <header class="w-full bg-white border-b border-[#2E7D32] sticky top-0 z-50">
   <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex h-14 items-center justify-between">
     <div class="flex items-center gap-3">
      <img alt="Heisenberg Protocol" class="h-8 w-auto" src="/project/692afde4b2e243410cabae6d/logos/logo_dbb8369b-d721-4b7b-b957-1a93dae384eb.png"/>
      <span class="text-lg font-semibold text-[#2E7D32]">
       Heisenberg Protocol
      </span>
      <span class="ml-2 text-sm text-gray-500">
       Onboarding
      </span>
     </div>
     <div class="flex items-center gap-4">
      <button class="p-2 rounded hover:bg-gray-100" title="Notifications">
       <i class="fas fa-bell text-gray-700">
       </i>
      </button>
      <button class="p-2 rounded hover:bg-gray-100" title="Messages">
       <i class="fas fa-comment-alt text-gray-700">
       </i>
      </button>
      <details class="relative">
       <summary class="list-none cursor-pointer flex items-center gap-2">
        <img alt="User" class="h-7 w-7 rounded-full" src="https://via.placeholder.com/28"/>
        <span class="text-sm text-gray-700">
         Guest
        </span>
        <i class="fas fa-chevron-down text-gray-500">
        </i>
       </summary>
       <div class="absolute right-0 mt-2 w-44 bg-white border border-gray-200 rounded-md shadow-lg">
        <a class="block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50" href="#farmer_profile">
         <i class="fas fa-user mr-2">
         </i>
         Profile
        </a>
        <a class="block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50" href="#privacy">
         <i class="fas fa-user-shield mr-2">
         </i>
         Privacy
        </a>
        <a class="block px-3 py-2 text-sm text-gray-700 hover:bg-gray-50" href="#">
         <i class="fas fa-sign-out-alt mr-2">
         </i>
         Exit
        </a>
       </div>
      </details>
     </div>
    </div>
   </div>
  </header>
  <!-- Main Content: Language Selection -->
  <main class="flex-1" id="language_selection">
   <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <!-- Helper bar: dark mode + voice assist -->
    <div class="flex items-center justify-end gap-4 mb-6">
     <button class="flex items-center gap-2 text-sm px-3 py-2 rounded-md border border-gray-200 hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-800" id="darkModeToggle">
      <i class="fas fa-moon text-gray-700 dark:text-gray-300">
      </i>
      <span>
       Dark Mode
      </span>
     </button>
     <label class="voice-toggle flex items-center gap-2 text-sm cursor-pointer select-none">
      <span class="text-gray-700 dark:text-gray-300">
       <i class="fas fa-volume-up mr-1 text-yieldGreen">
       </i>
       Voice Assist
      </span>
      <div class="relative">
       <input class="sr-only" id="voiceAssistToggle" type="checkbox"/>
       <div class="w-10 h-5 bg-gray-300 rounded-full shadow-inner dark:bg-gray-700">
       </div>
       <div class="toggle-dot absolute w-5 h-5 bg-white rounded-full shadow -left-0 -top-0 transition">
       </div>
      </div>
     </label>
    </div>
    <div class="grid md:grid-cols-2 gap-8 items-center">
     <!-- Welcome / Hero copy -->
     <div class="space-y-4">
      <div class="flex items-center gap-3">
       <img alt="YieldWise" class="h-10 w-10" onerror="this.src='https://picsum.photos/seed/yieldwise/80/80'" src="/project/692afde4b2e243410cabae6d/logos/logo_dbb8369b-d721-4b7b-b957-1a93dae384eb.png"/>
       <div>
        <h1 class="text-2xl md:text-3xl font-semibold text-[#2E7D32]">
         Choose Your Language
        </h1>
        <p class="text-sm text-gray-600">
         A multilingual, farmer-friendly advisory experience. Select a language to personalize your interface.
        </p>
       </div>
      </div>
      <ul class="text-gray-700 text-sm list-disc pl-6">
       <li>
        Your preference is saved on this device.
       </li>
       <li>
        Change anytime from settings in the dashboard.
       </li>
       <li>
        Voice assist reads advisories in your chosen language (where supported).
       </li>
      </ul>
     </div>
     <!-- Selection Card -->
     <div class="lang-card rounded-xl p-6">
      <div class="flex items-center justify-between mb-4">
       <h2 class="text-lg font-semibold text-gray-800">
        Available Languages
       </h2>
       <span class="text-xs text-gray-500">
        Mobile-first • Region-friendly
       </span>
      </div>
      <div class="grid grid-cols-2 sm:grid-cols-3 gap-3" id="languageGrid">
       <!-- Buttons injected via JS -->
      </div>
      <div class="mt-6 flex items-center gap-3">
       <i class="fa-solid fa-circle-info text-yieldGreen">
       </i>
       <p class="text-xs text-gray-600">
        After selecting, you’ll be redirected to the Home Dashboard.
       </p>
      </div>
     </div>
    </div>
    <!-- Notification area -->
    <div class="mt-8 hidden" id="notifyArea">
     <div class="rounded-md border border-yellow-300 bg-yellow-50 p-3 text-sm text-yellow-800 flex items-start gap-2">
      <i class="fa-solid fa-triangle-exclamation">
      </i>
      <span id="notifyText">
       Notification
      </span>
     </div>
    </div>
   </section>
  </main>
  <!-- Footer (common component) -->
  <footer class="w-full bg-white border-t border-gray-200">
   <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
    <div class="flex items-center gap-2">
     <img alt="Logo" class="h-5 w-5" src="/project/692afde4b2e243410cabae6d/logos/logo_dbb8369b-d721-4b7b-b957-1a93dae384eb.png"/>
     <span class="text-sm text-gray-600">
      Heisenberg Protocol
     </span>
    </div>
    <div class="flex items-center gap-4">
     <a class="text-sm text-gray-600 hover:text-[#2E7D32]" href="#terms">
      Terms
     </a>
     <a class="text-sm text-gray-600 hover:text-[#2E7D32]" href="#privacy">
      Privacy
     </a>
     <a class="text-sm text-gray-600 hover:text-[#2E7D32]" href="#help">
      Help
     </a>
    </div>
   </div>
  </footer>
  <!-- Scripts: Language Selection Logic, Dark Mode, Voice Assist -->
  <script>
   (function() {
    // Redirect if language already set
    try {
        const lang = localStorage.getItem('user_language');
        if (lang) {
            window.location.replace('./home_dashboard.html');
            return;
        }
    } catch (e) {}

    // Apply dark mode from preference
    try {
        const darkPref = localStorage.getItem('dark_mode');
        if (darkPref === 'true') {
            document.documentElement.classList.add('dark');
        }
    } catch (e) {}
})();
  </script>
  <script>
   const languages = [{
    code: 'en',
    name: 'English'
}, {
    code: 'hi',
    name: 'हिन्दी'
}, {
    code: 'or',
    name: 'ଓଡିଆ'
}, {
    code: 'mr',
    name: 'मराठी'
}, {
    code: 'bn',
    name: 'বাংলা'
}, {
    code: 'te',
    name: 'తెలుగు'
}, {
    code: 'ta',
    name: 'தமிழ்'
}, ];

function speak(text) {
    try {
        if (!('speechSynthesis' in window)) return;
        const enabled = document.getElementById('voiceAssistToggle')?.checked;
        if (!enabled) return;
        const utter = new SpeechSynthesisUtterance(text);
        utter.lang = 'en-IN';
        speechSynthesis.cancel();
        speechSynthesis.speak(utter);
    } catch (e) {}
}

function showToast(message, type = 'success') {
    const icon = type === 'success' ? 'success' : type === 'error' ? 'error' : 'info';
    Swal.fire({
        toast: true,
        position: 'top-end',
        showConfirmButton: false,
        timer: 1800,
        icon,
        title: message,
    });
}

function renderLanguages() {
    const grid = document.getElementById('languageGrid');
    if (!grid) return;
    grid.innerHTML = '';
    languages.forEach((lang) => {
        const btn = document.createElement('button');
        btn.className = 'lang-btn group w-full px-4 py-3 rounded-lg border border-green-200 bg-white text-gray-800 hover:border-[#2E7D32] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#2E7D32] flex items-center gap-3';
        btn.setAttribute('data-code', lang.code);
        btn.innerHTML = `<span class="shrink-0 w-9 h-9 rounded-full bg-green-50 border border-green-100 flex items-center justify-center"><i class="fa-solid fa-language text-[#2E7D32]"></i></span><span class="text-sm font-medium">${lang.name}</span>`;
        btn.addEventListener('click', () => onLanguageSelect(lang));
        grid.appendChild(btn);
    });
    speak('Please choose your language.');
}

function onLanguageSelect(lang) {
    try {
        localStorage.setItem('user_language', lang.code);
        localStorage.setItem('user_language_name', lang.name);
        localStorage.setItem('language_set_at', new Date().toISOString());
        showToast(`Language set to ${lang.name}`, 'success');
        speak(`${lang.name} selected. Redirecting to dashboard.`);
        setTimeout(() => {
            window.location.href = './home_dashboard.html';
        }, 900);
    } catch (e) {
        const notifyArea = document.getElementById('notifyArea');
        const notifyText = document.getElementById('notifyText');
        if (notifyArea && notifyText) {
            notifyText.textContent = 'Unable to save your preference. Please check browser settings.';
            notifyArea.classList.remove('hidden');
        }
        showToast('Unable to save your preference', 'error');
    }
}

document.addEventListener('DOMContentLoaded', () => {
    renderLanguages();

    // Dark mode toggle
    const darkToggle = document.getElementById('darkModeToggle');
    if (darkToggle) {
        darkToggle.addEventListener('click', () => {
            const root = document.documentElement;
            const nowDark = !root.classList.contains('dark');
            if (nowDark) root.classList.add('dark');
            else root.classList.remove('dark');
            try {
                localStorage.setItem('dark_mode', String(nowDark));
            } catch (e) {}
        });
    }

    // Voice assist immediate prompt
    const voiceTgl = document.getElementById('voiceAssistToggle');
    if (voiceTgl) {
        voiceTgl.addEventListener('change', () => {
            if (voiceTgl.checked) {
                speak('Voice assist enabled. Please choose your language.');
            } else {
                try {
                    speechSynthesis.cancel();
                } catch (e) {}
            }
        });
    }
});
  </script>
 </body>
</html>
